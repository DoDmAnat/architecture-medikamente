# Cutover-план по миграции системы Medikamente

## 1. Исходная ситуация и целевая модель

### Текущее состояние

* Монолитное приложение, развернутое на Windows Server 2022.
* 1С:Бухгалтерия и 1С:Торговля работают в файловом режиме.
* Хранение документов и рабочих файлов организовано на файловом сервере.
* Интеграция с кассовыми аппаратами осуществляется через OLE-автоматизацию.
* В системе работают 35 сотрудников в одном офисе.

### Планируемая архитектура

* Переход на микросервисную архитектуру.
* Использование PostgreSQL с применением шифрования данных.
* Внедрение API Gateway, Identity and Access Management (IAM), систем ролевого (RBAC) и атрибутивного (ABAC) контроля
  доступа.
* Развертывание веб-порталов для клиентов и работы ресепшена.
* Автоматизация интеграции с лабораторной информационной системой.

### Ограничения

* Недопустимость длительных простоев в работе клиники.
* Обязательное соблюдение требований к защите персональных медицинских данных (PHI).
* Ограниченные ресурсы небольшого IT-отдела.
* Планируемое открытие новых филиалов в будущем.

---

## 2. Подход к миграции

### Сравнение стратегий

| Параметр                  | High-Level Design (Полная замена) | Parallel Run (Параллельный запуск) | Branch by Abstraction (Абстрагирование) |
|:--------------------------|:----------------------------------|:-----------------------------------|:----------------------------------------|
| **Сложность реализации**  | Высокая                           | Средняя                            | Высокая                                 |
| **Риск простоя бизнеса**  | Высокий                           | Низкий                             | Средний                                 |
| **Общие сроки перехода**  | Короткие                          | Длительные                         | Средние                                 |
| **Требования к ресурсам** | Высокие                           | Умеренные                          | Высокие                                 |
| **Простота отката**       | Сложный                           | Простой                            | Средняя                                 |
| **Стоимость**             | Низкая                            | Высокая                            | Средняя                                 |

**Выбранная стратегия:** **Parallel Run (Параллельный запуск).**

**Обоснование выбора:**

* Гарантирует непрерывность операционной деятельности клиники.
* Позволяет верифицировать корректность работы новой системы, сравнивая результаты с действующей.
* Дает персоналу время на адаптацию к новым процессам без критического давления.
* Обеспечивает простой и безопасный путь для отката в случае серьезных проблем.

---

## 3. Cutover-план

### Фаза 0. Подготовка (2 недели)

| Этап    | Содержание работ                                               | Ответственные                                |
|:--------|:---------------------------------------------------------------|:---------------------------------------------|
| **0.1** | Инвентаризация и аудит всех данных в существующих системах     | Бизнес-аналитик                              |
| **0.2** | Очистка и приведение данных в согласованный вид                | Бизнес-аналитик + руководители подразделений |
| **0.3** | Развертывание и настройка новой инфраструктуры                 | Технический директор + инженер DevOps        |
| **0.4** | Разработка и настройка ETL-конвейеров для синхронизации данных | Инженер DevOps + разработчик                 |
| **0.5** | Обучение ключевых сотрудников IT-отдела                        | Привлеченный подрядчик / вендор              |

### Фаза 1. Перенос данных (1 неделя)

| Этап    | Содержание работ                                                    |
|:--------|:--------------------------------------------------------------------|
| **1.1** | Создание полных резервных копий всех систем перед началом миграции. |
| **1.2** | Перенос неизменяемых справочников (номенклатура, подразделения).    |
| **1.3** | Миграция основных мастер-данных (данные пациентов, врачей).         |
| **1.4** | Перенос транзакционных данных (записи, истории обращений).          |
| **1.5** | Комплексная проверка целостности и полноты перенесенных данных.     |

### Фаза 2. Параллельная работа (4 недели)

| Этап    | Содержание работ                                                                                        |
|:--------|:--------------------------------------------------------------------------------------------------------|
| **2.1** | Запуск новой системы в режиме "только для чтения".                                                      |
| **2.2** | Подключение к работе в новой системе пилотной группы пользователей (2-3 человека).                      |
| **2.3** | Поэтапное расширение круга пользователей, работающих в обеих системах.                                  |
| **2.4** | Полный переход всех пользователей на работу в новой системе. Старая система переводится в режим чтения. |
| **2.5** | Непрерывная синхронизация любых изменений из новой системы в старую (односторонняя).                    |

### Фаза 3. Стабилизация (2 недели)

* Активный мониторинг производительности и доступности новой системы.
* Сбор обратной связи от пользователей и анализ возникающих проблем.
* Оперативное исправление обнаруженных ошибок.
* Тонкая настройка процессов для повышения эффективности.

### Фаза 4. Отключение старой системы (1 неделя)

* Финальная проверка корректности всех данных в новой системе.
* Остановка процессов синхронизации (ETL).
* Архивация данных и конфигураций старой системы для хранения.
* Формирование итоговой проектной документации.
* Официальное закрытие проекта миграции.

---

## 4. План отката

### Основания для инициации отката

* Фактическая или потенциальная потеря критичных данных.
* Длительная (более 30 минут) недоступность новой системы для пользователей.
* Критически высокий уровень негативной обратной связи от сотрудников, препятствующий работе.
* Обнаружение уязвимостей или инцидентов безопасности в новой системе.

### Процедура отката

1. Принятие решения об откате руководством проекта.
2. Немедленное информирование всех пользователей.
3. Техническое переключение рабочих процессов обратно на предыдущую систему.
4. Синхронизация данных, созданных в новой системе, в старую (при возможности и необходимости).
5. Подтверждение полной работоспособности старой системы.
6. Проведение анализа причин, приведших к откату.

**Максимально допустимое время полного отката — 4 часа.**

---

## 5. Риски и управление ими

| №     | Потенциальный риск                                                                  | Уровень влияния | Меры предотвращения и смягчения                                                                |
|:------|:------------------------------------------------------------------------------------|:----------------|:-----------------------------------------------------------------------------------------------|
| **1** | Ошибки при переносе или преобразовании данных                                       | Критическое     | Резервное копирование на каждом этапе, многоуровневая проверка данных.                         |
| **2** | Рассинхронизация данных между старой и новой системами в период параллельной работы | Высокое         | Усиленный мониторинг ETL-процессов, оповещения о сбоях.                                        |
| **3** | Сопротивление персонала новым процедурам и интерфейсам                              | Среднее         | Заблаговременное обучение, вовлечение лидеров мнений, поддержка "горячей линии".               |
| **4** | Перегрузка и усталость сотрудников IT-отдела                                        | Среднее         | Четкое планирование дежурств, привлечение внешних консультантов на пиковые периоды.            |
| **5** | Недостаточная производительность новой системы под нагрузкой                        | Высокое         | Проведение нагрузочного тестирования на предварительных этапах, наличие плана масштабирования. |
| **6** | Срыв общих сроков миграции                                                          | Среднее         | Заложение временных буферов в график, приоритизация задач.                                     |
| **7** | Сбои в интеграции с кассовыми аппаратами (ККМ)                                      | Высокое         | Всестороннее тестирование интеграции на стенде, подготовка временного ручного протокла работы. |

---

## 6. Контрольные точки

* **KPI 1:** Готовая к работе инфраструктура новой системы.
* **KPI 2:** Успешное завершение переноса данных с подтверждением целостности.
* **KPI 3:** Отсутствие критических инцидентов в работе пилотной группы пользователей.
* **KPI 4:** Полный перевод всех бизнес-процессов на новую систему.
* **KPI 5:** Подтверждение стабильной и предсказуемой работы системы в течение двух недель.